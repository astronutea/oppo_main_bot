import asyncio
import logging

from aiogram import Bot, Dispatcher, types, exceptions
from aiogram import F
from aiogram.enums import ParseMode
from aiogram.filters import Command, CommandObject
from aiogram.types import Message

from config import BOT_TOKEN
from db_request import registration_ref
from keyboards import main_kb

# –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
logging.basicConfig(level=logging.INFO)
# –û–±—ä–µ–∫—Ç –±–æ—Ç–∞
bot = Bot(token=BOT_TOKEN)
# –î–∏—Å–ø–µ—Ç—á–µ—Ä
dp = Dispatcher()


@dp.message(Command(commands=["start"]))
async def start_command(message: Message, command: CommandObject):
    # –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–º–∞–Ω–¥—ã /start
    command_args: str = command.args
    try:
        await message.answer("–ü—Ä–∏–≤–µ—Ç!\n\n"
                             "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É <em><b>–ö—Ä–µ–ø–∫–∏–πOPPO—Ä–µ—à–µ–∫!</b></em>üå∞\n\n"
                             "–ó–¥–µ—Å—å –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è, –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤–∏–Ω–∫–∞–º–∏ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤ OPPO –∏ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏.\n\n"
                             "–ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω, —á—Ç–æ–±—ã <em>–∫–æ–ª–æ—Ç—å –æ—Ä–µ—Ö–∏</em>, –∏ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å —Å–≤–æ–π –¥–æ—Ö–æ–¥!\n\n"
                             "–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ <b>–¥—Ä—É–∑—å—è—Ö</b> ‚Äî –ø—Ä–∏–≤–æ–¥–∏—Ç–µ –∏—Ö –≤ –∏–≥—Ä—É –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –µ—â–µ –±–æ–ª—å—à–µ –≤–º–µ—Å—Ç–µ!",
                             reply_markup=main_kb, parse_mode=ParseMode.HTML)
        registration_ref(message.from_user.username, message.from_user.first_name, message.from_user.last_name, int(message.from_user.id), str(command_args))
    except exceptions.TelegramForbiddenError:
        print(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {message.from_user.id} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞")


@dp.callback_query(F.data == "rules")
async def show_rules(callback: types.CallbackQuery):
    await callback.message.answer(f"<em><ins>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</ins></em>\n\n"
                                  f"- –ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ —ç–∫—Ä–∞–Ω, —á—Ç–æ–±—ã –∫–æ–ª–æ—Ç—å –æ—Ä–µ—Ö–∏.\n\n"
                                  f"- <b>–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è</b>, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –µ—â–µ –±–æ–ª—å—à–µ!\n\n"
                                  f"- –ó–∞—Ö–æ–¥–∏—Ç–µ –≤ –∏–≥—Ä—É <b>—Ä–µ–≥—É–ª—è—Ä–Ω–æ</b>, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à–µ —è–¥–µ—Ä –æ—Ä–µ—Ö–æ–≤ –¥–ª—è –æ–±–º–µ–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏.\n\n"
                                  f"- <b>–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π</b>, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ –µ—â–µ –±–æ–ª—å—à–µ.\n\n"
                                  f"- <b>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤–æ—Å—Ç—è–º–∏</b>, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ!",
                                  parse_mode=ParseMode.HTML, reply_markup=main_kb)


@dp.callback_query(F.data == "info")
async def show_info(callback: types.CallbackQuery):
    await callback.message.answer(f"1Ô∏è‚É£ –í—Å–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –ø—Ä–∞–≤–∏–ª–∞–º –ê–∫—Ü–∏–∏, –±—É–¥—É—Ç –≤—ã–ø–ª–∞—á–µ–Ω—ã –≤ –±–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—ã–ø–ª–∞—Ç—ã –∏–¥—É—Ç.\n"
                                  f"2Ô∏è‚É£ –ü—Ä—è–º–æ —Å–µ–π—á–∞—Å –≤—Å–µ –µ—â–µ –µ—Å—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–±–ª—é–¥–µ–Ω—ã –≤—Å–µ —É—Å–ª–æ–≤–∏—è. –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ –ê–∫—Ü–∏–∏ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫ –∫–æ–Ω—Ü—É, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ—Ç–æ—Ä–æ–ø–∏—Ç—å—Å—è!\n"
                                  f"–ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ –±—É–¥–µ—Ç –∏—Å—á–µ—Ä–ø–∞–Ω, –º—ã –Ω–µ —Å–º–æ–∂–µ–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è.\n"
                                  f"üîç–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –í–°–ï —É—Å–ª–æ–≤–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è:\n"
                                  f"- –∏–≥—Ä–æ–≤–∞—è —Å–µ—Å—Å–∏—è –º–∏–Ω–∏–º—É–º 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥ (–≤ —Ç–µ—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –Ω—É–∂–Ω–æ –±—ã–ª–æ –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –∏–≥—Ä—É, —Å–æ–≤–µ—Ä—à–∞—Ç—å –∏–≥—Ä–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è)\n"
                                  f"- –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º 4-—Ö –∑–∞–¥–∞–Ω–∏–π\n"
                                  f"- –±–æ–ª–µ–µ 100 000 –æ—Ä–µ—Ö–æ–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ\n"
                                  f"- –≤—ã –µ—â–µ –Ω–µ –ø–æ–ª—É—á–∞–ª–∏ –≤—ã–ø–ª–∞—Ç—É\n"
                                  f"üèÜ–ï—Å–ª–∏ –≤—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –≤—Å–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏, —Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å ¬´–ü–æ–ª—É—á–∏—Ç—å –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ¬ª –≤–æ –≤–∫–ª–∞–¥–∫–µ ¬´–û–±–º–µ–Ω¬ª. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è.\n"
                                  f"–ï—Å–ª–∏ –≤—ã —É–∂–µ –±—ã–ª–∏ –≤ –±–æ—Ç–µ –≤—ã–ø–ª–∞—Ç –¥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π, —Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–∂–º–∏—Ç–µ /start, –∫–æ–≥–¥–∞ –∑–∞–π–¥–µ—Ç–µ –≤ –Ω–µ–≥–æ —Å–Ω–æ–≤–∞.\n"
                                  f"‚è∞ –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –¥–æ –º–æ–º–µ–Ω—Ç–∞ –µ–≥–æ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –∏–ª–∏ –¥–æ 27 –∞–≤–≥—É—Å—Ç–∞ 2024 –≥–æ–¥–∞.\n"
                                  f"–û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å –Ω–∞ —Å–≤—è–∑–∏ —Å –Ω–∞–º–∏ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –∫–∞–Ω–∞–ª–µ OPPO –†–æ—Å—Å–∏—è –≤ Telegram. –ú—ã –≥–æ—Ç–æ–≤–∏–º –¥–ª—è –≤–∞—Å —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ. üéÅ",
                                  reply_markup=main_kb)


# –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–ª–ª–∏–Ω–≥–∞ –Ω–æ–≤—ã—Ö –∞–ø–¥–µ–π—Ç–æ–≤
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())